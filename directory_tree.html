<!DOCTYPE html>
<html>
  <head>
    <title>Directory Tree Examples</title>
  </head>
  <body>
    <h1>Directory Tree Examples</h1>

    <button onclick="displayExample(1)">Example 1</button>
    <button onclick="displayExample(2)">Example 2</button>
    <button onclick="displayExample(3)">Example 3</button>

    <pre id="result"></pre>

    <script>
      async function directoryToTree(rootPath, maxDepth) {
        const response = await fetch(rootPath);
        const isDirectory = response.ok && response.headers.get('content-type').includes('text/html');
        const name = rootPath.split('/').pop();
        const fullPath = rootPath;

        if (maxDepth === 0 || !isDirectory) {
          return {
            name,
            path: fullPath,
            type: isDirectory ? 'dir' : 'file',
            size: isDirectory ? 4096 : (await response.blob()).size,
          };
        }

        const html = await response.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const links = Array.from(doc.querySelectorAll('a'));
        const children = await Promise.all(
          links.map(async (link) => {
            const childPath = new URL(link.href, rootPath).href;
            return directoryToTree(childPath, maxDepth - 1);
          })
        );

        return {
          name,
          path: fullPath,
          type: 'dir',
          size: 4096,
          children,
        };
      }

      async function displayExample(example) {
        // Clear previous result
        document.getElementById('result').innerHTML = '';

        // Call the appropriate example function and display the result
        if (example === 1) {
          const result = await directoryToTree('dummy_dir/a_dir', 5);
          document.getElementById('result').textContent = JSON.stringify(result, null, 2);
        } else if (example === 2) {
          const result = await directoryToTree('dummy_dir', 5);
          document.getElementById('result').textContent = JSON.stringify(result, null, 2);
        } else if (example === 3) {
          const result = await directoryToTree('dummy_dir', 1);
          document.getElementById('result').textContent = JSON.stringify(result, null, 2);
        }
      }
    </script>
  </body>
</html>
